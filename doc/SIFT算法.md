# SIFT算法

尺度不变特征转换即SIFT是一种常见的计算机视觉的算法，用于检测与描述图像中的局部特征。SIFT特征是基于物体上一些局部外观的兴趣点，与图像的大小、旋转等无关。对于光线、噪声等鲁棒性较强。在学习SIFT算法之前，需要清楚什么是SIFT关键点以及什么SIFT尺度空间。

## SIFT关键点

SIFT关键点指的是图像中的一些十分突出的点，这些点不会因光照或者旋转等图像改变而消失。比如角点、边缘点、暗区域的亮点以及亮区域的暗点。既然两幅图像中有相同的景物，那么使用某种方法分别提取各自的稳定点，这些点之间会有相互对应的匹配点。所谓关键点，就是在不同的尺度空间的图像下检测出具有方向信息的局部极值点。这些特征点具有三个特征：尺度、方向、大小。


## 尺度空间

![image](https://user-images.githubusercontent.com/27406337/153530380-53548d46-edec-4c97-948f-335687de5ea4.png)


## 算法实现

1. **图像高斯金字塔**

图像高斯金字塔实际上是一种图像的尺度空间（分线性和非线性空间），尺度概念用来模拟观察者距离物体的远近程度，在模拟物体远近的同时，还得考虑物体的粗细程度。高斯金字塔的创建过程如下图所示：

![image](https://user-images.githubusercontent.com/27406337/153530620-7def44f0-6169-4f6b-8302-ad904975d896.png)

![image](https://user-images.githubusercontent.com/27406337/153532012-164e76b7-c3ae-4354-967a-d5ebe39513bf.png)

参数：

- 金字塔组数：一般情况下取$\lfloor \log_{2}(\min(M, N))\rfloor - 3$或者$\lfloor \log_{2}(\min(M, N))\rfloor - 4$
- 每层组数：$S_1 = s+3$，s为极值检测需要的层数，一般取3到5。假设高斯金字塔每组有S=5层，则高斯差分金字塔有S-1=4。那么只能在高斯差分金字塔每组的中间两层图像求极值，所以n=2。
- $k = 2^{\frac{1}{s}}$，$\sigma_0=1.6$

具体的生成过程可以参考：https://blog.csdn.net/lhanchao/article/details/52345845

2. **关键点检测**

 关键点是由DOG空间的局部极值点组成的，关键点的初步探查是通过同一组内各DoG相邻两层图像之间比较完成的。为了寻找DoG函数的极值点，每一个像素点要和它所有的相邻点比较，看其是否比它的图像域和尺度域的相邻点大或者小。如图下图所示，中间的检测点和它同尺度的8个相邻点和上下相邻尺度对应的9×2个点共26个点比较，以确保在尺度空间和二维图像空间都检测到极值点。

![image](https://user-images.githubusercontent.com/27406337/153533550-58f98670-0574-4569-a41e-1d47198e2384.png)

以上方法检测到的极值点是离散空间的极值点，以下通过拟合三维二次函数来精确确定关键点的位置和尺度，同时去除低对比度的关键点和不稳定的边缘响应点(因为DoG算子会产生较强的边缘响应)，以增强匹配稳定性、提高抗噪声能力。离散空间的极值点并不是真正的极值点，下图显示了二维函数离散空间得到的极值点与连续空间极值点的差别。利用已知的离散空间点插值得到的连续空间极值点的方法叫做子像素插值。
![image](https://user-images.githubusercontent.com/27406337/153533673-821019ef-9df4-4575-ad3b-12bd5249af1d.png)

可以参考：https://zhuanlan.zhihu.com/p/343522892

3. **关键点的方向**

统计以特征点为圆心，以该特征点所在的高斯图像的尺度的1.5倍为半径的圆内的所有的像素的梯度方向及其梯度幅值，并做1.5σ的高斯滤波(高斯加权，离圆心也就是关键点近的幅值所占权重较高)。
![image](https://user-images.githubusercontent.com/27406337/153533784-94680923-6fd6-487e-8f26-8cc91f0eeeef.png)


4. **构建关键点描述符**

上述过程，只是找到关键点并确定了其方向，但SIFT算法核心用途在于图像的匹配，我们需要对关键点进行数学层面的特征描述，也就是构建关键点描述符。详情可以参考：https://zhuanlan.zhihu.com/p/343522892 。